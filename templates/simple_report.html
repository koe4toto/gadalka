{% extends 'layout.html' %}

{% block body %}
    <a class="text-secondary" href="/reports">Отчеты</a><br>
    &#8595;
    <div class="row">
      <div class="col-10">
          <h1>{{ report[0][1] }}</h1>
      </div>
    <div class="col-2">
      <form action="{{url_for('reports.delete_report', id=report[0][0])}}" method="post">
          <input type="hidden" name="_method" value="DELETE">
          <input type="submit" value=" Удалить" class="btn btn-link float-right text-danger">
      </form>
    </div>
    </div>

    <p  class="lead">{{ report[0][2] }}</p>
    <a class="btn btn-outline-primary" href="/edit_report/{{ report[0][0] }}"><i class="fas fa-pencil-alt"></i> Редактировать</a>

    <hr>


<style>

td {
  border-bottom: 1px solid #fbfbfb;
  background-size: 0% 100%;
  background-repeat: no-repeat;
  -webkit-transition: all .1s ease-out;
  -moz-transition: all .1s ease-out;
  transition: all .1s ease-out;

}

td.int {
  width: 10%;
  background-image: -webkit-linear-gradient(right, #d49800, #d49844);
  background-image: -moz-linear-gradient(right, #d49800, #d49844);
  background-image: linear-gradient(right, #d49800, #d49844);
  background-position: left top;
}

td.blew {
  width: 10%;
  background-image: -webkit-linear-gradient(right, #249843, #249844);
  background-image: -moz-linear-gradient(right, #249834, #249844);
  background-image: linear-gradient(right, #249834, #249844);
  background-position: left top;
}

td:numb {
}


</style>

<script type="text/javascript">
var twoColComp = {
  init: function (){
    var tables = document.getElementsByTagName('table');

    for(var i = 0; i < tables.length; i++) {
      if (new RegExp('(^| )two-column-comp( |$)', 'gi').test(tables[i].className)){
         return;
      }

      var h = tables[i].clientHeight,
          t = tables[i].getBoundingClientRect().top,
          wT = window.pageYOffset || document.documentElement.scrollTop,
          wH = window.innerHeight;

      if(wT + wH > t + h/2){
         this.make(tables[i]);
       }
    }
  },

  make : function(el){

    var rows = el.getElementsByTagName('tr'),
        vals = [],
        max,
        percent;

    for(var x = 0; x < rows.length; x++) {
      var cells = rows[x].getElementsByClassName('numb');
      for(var y = 0; y < cells.length; y++){
        vals.push(parseInt(cells[y].innerHTML, 10));
      }
    }

    max = Math.max.apply( Math, vals );
    percent = 100/max;

    const columnsCount = cells.length;
    let maxValues = [[],[]];
    let percentValues = [[],[]];
    for(let count = 0; count < columnsCount; count++) {
      maxValues[count] = Math.max.apply( Math, vals.filter((value, index) => index%columnsCount === count));
      percentValues[count] = 100/maxValues[count];  // 100/Math.max.apply( Math, vals.filter((value, index) => index%columnsCount === count));

    }

    for(x = 0; x < rows.length; x++) {
      var cells = rows[x].getElementsByClassName('numb');
      for(var y = 0; y < cells.length; y++){
        var currNum = parseInt(cells[y].innerHTML, 10);
        cells[y].style.backgroundSize = percentValues[(y) % columnsCount] * currNum + "% 100%"; // y + 1 потому что первая колонка - значения легенды графика - Value A, for example
        cells[y].style.transitionDelay = x/20 + "s";
      }
    }

    el.className =+ " two-column-comp"
  }
}

window.onload = function(){
  twoColComp.init();
}

window.onscroll = function(){
  twoColComp.init();
}

</script>



<div class="row">

  <div class="col-md-10">
      <table class="table table-hover" style="width: 100%;">
        <tr>
          <th>2014</th>
          <th>2015</th>
          <th>Текстовая</th>
        </tr>
        <tr>
          <td class="numb int">2</td>
          <td class="numb blew">8</td>
          <td>ываыва</td>
        </tr>
        <tr>
          <td class="numb int">3</td>
          <td class="numb blew">9</td>
          <td>ываыва</td>
        </tr>
        <tr>
          <td class="numb int">7</td>
          <td class="numb blew">11</td>
          <td>ываыва</td>
        </tr>
        <tr>
          <td class="numb int">10</td>
          <td class="numb blew">9</td>
          <td>ываыва</td>
        </tr>
        <tr>
          <td class="numb int">9</td>
          <td class="numb blew">10</td>
          <td>ываыва</td>
        </tr>
        <tr>
          <td class="numb int">11</td>
          <td class="numb blew">10</td>
          <td>ываыва</td>
        </tr>
        <tr>
          <td class="numb int">15</td>
          <td class="numb blew">9</td>
          <td>ываыва</td>
        </tr>
        <tr>
          <td class="numb int">18</td>
          <td class="numb blew">10</td>
          <td>ываыва</td>
        </tr>
        <tr>
          <td class="numb int">17</td>
          <td class="numb blew">11</td>
          <td>ываыва</td>
        </tr>
        <tr>
          <td class="numb int">60</td>
          <td class="numb blew">12</td>
          <td>ываыва</td>
        </tr>
      </table>
  </div>


  </div>
</div>

{% endblock %}
